# ========================================
# FastAPI 高德地图扣子插件 环境配置
# ========================================

# 应用配置
# ---------------------------
# 应用主机地址，默认0.0.0.0（允许外部访问）
APP_HOST=0.0.0.0

# 应用端口，默认8000
APP_PORT=8000
# 基础URL，用于生成完整的访问链接
APP_BASE_URL=http://127.0.0.1:8000
# 数据库文件路径
DB_PATH=./data/map.db
# MySQL 数据库连接配置 (可选，若配置则覆盖 DB_PATH)
# 格式: mysql+pymysql://用户名:密码@主机地址:端口/数据库名
# 示例: DB_URL=mysql+pymysql://root:password@rm-cn-xx.rds.aliyuncs.com:3306/gaode_deploy
# DB_URL=
# API密钥配置（重要）
# ---------------------------
# API密钥，用于访问鉴权
#
# ⚠️ 重要：生产环境必须修改！
# 密钥要求：
# - 长度至少16位
# - 包含字母、数字和特殊字符
# - 定期更换
API_KEYS=["gaode-map-plugin-2025-dev-only"]

# 文件保留时间（小时）
# 生成的地图页面将在多久后自动删除
# 默认：7天
FILE_LIFETIME_HOURS=168

# 清理任务间隔（小时）
# 每隔多久检查并删除过期文件
# 默认：6小时
CLEANUP_INTERVAL_HOURS=24

# 高德地图API配置
# ---------------------------
# Web 服务（REST API）Key
AMAP_WEB_SERVICE_KEY=

# Web JS API Key（用于前端脚本引入）
AMAP_JS_API_KEY=

# Web JS API 安全码（如未开启可留空）
AMAP_JS_SECURITY_CODE=

# 天地图 Web 瓦片服务 Key（tk）
TIANDITU_KEY=

# 本地历史数据查询服务配置
# ---------------------------
# 分开部署（生产常见）：填写 search 服务对 app 可达的地址，例如 http://search.your-domain.com:8001
# 同一 compose 网络部署：可填写 http://search:8001
LOCAL_QUERY_BASE_URL=http://search.your-domain.com:8001
LOCAL_QUERY_COORD_SYSTEM=gcj02

# 等时圈（Isochrone）配置
# ---------------------------
VALHALLA_BASE_URL=http://127.0.0.1:8002
VALHALLA_TIMEOUT_S=60
# 降低线程数以避免 Windows 下 "Two many open files" 错误
VALHALLA_SERVER_THREADS=2

# ArcGIS HTTP bridge
# ---------------------------
# Enable ArcGIS bridge when use_arcgis=true in H3 analysis request.
ARCGIS_BRIDGE_ENABLED=true
# Bridge service base URL.
# Windows Docker Desktop: http://host.docker.internal:18081
# Linux Docker: keep host.docker.internal and map it via compose extra_hosts(host-gateway)
ARCGIS_BRIDGE_BASE_URL=http://host.docker.internal:18081
# Shared token sent via X-ArcGIS-Token header.
ARCGIS_BRIDGE_TOKEN=
# Request timeout from backend to bridge (seconds).
ARCGIS_BRIDGE_TIMEOUT_S=300
# Export timeout from backend to bridge (seconds).
ARCGIS_EXPORT_TIMEOUT_S=600
# Maximum export file size accepted from bridge (MB).
ARCGIS_EXPORT_MAX_MB=512

# ArcGIS host bridge runtime (Windows host process)
# ---------------------------
# Note: ARCGIS_TOKEN should be the same value as ARCGIS_BRIDGE_TOKEN.
ARCGIS_TOKEN=
ARCGIS_PYTHON_PATH=C:\Python27\ArcGIS10.7\python.exe
ARCGIS_SCRIPT_PATH=D:\Coding\map_analyse\scripts\arcgis_h3_pipeline.py
ARCGIS_EXPORT_SCRIPT_PATH=D:\Coding\map_analyse\scripts\arcgis_h3_export.py
ARCGIS_ROAD_SYNTAX_SCRIPT_PATH=D:\Coding\map_analyse\scripts\arcgis_road_syntax_webgl.py
ARCGIS_BRIDGE_PORT=18081
ARCGIS_ANALYZE_CACHE_TTL_SEC=900
ARCGIS_ANALYZE_CACHE_MAX_ENTRIES=32

# depthmapX CLI
# ---------------------------
# depthmapXcli 可执行文件路径（可写绝对路径）
DEPTHMAPX_CLI_PATH=/usr/local/bin/depthmapXcli
# 单条 depthmapXcli 命令超时（秒）
DEPTHMAPX_TIMEOUT_S=300
# Tulip 分箱数（4~1024，1024最接近全角度）
DEPTHMAPX_TULIP_BINS=1024
# 路网抓取 Overpass 端点（仅本地/私有实例）
# 下面 6 个变量在 docker-compose 中作为挂载与导入参数使用，建议在 .env 中统一维护（必填）
OVERPASS_ENDPOINT=http://overpass/api/interpreter
# Overpass 导入使用的 PBF 文件名（放在 OVERPASS_SOURCE_DIR 目录内）
OVERPASS_PBF_FILE=hunan-260201.osm.pbf
# Valhalla 输入目录（宿主机）
VALHALLA_CUSTOM_FILES_DIR=/mnt/d/MapData/osm_source
# Valhalla 瓦片输出目录（宿主机）
VALHALLA_TILES_DIR=/mnt/d/MapData/valhalla_tiles
# Overpass 数据库存储目录（宿主机）
OVERPASS_DB_DIR=/mnt/d/MapData/overpass_db
# Overpass PBF 源目录（宿主机）
OVERPASS_SOURCE_DIR=/mnt/d/MapData/osm_source

# CORS跨域配置
# ---------------------------
# 允许访问的域名列表（JSON数组格式）
# - 开发环境可以使用: ["*"]（允许所有域名）
# - 生产环境必须指定具体域名，例如:
#   CORS_ORIGINS=["https://www.coze.cn","https://coze.cn"]
CORS_ORIGINS=["*"]
